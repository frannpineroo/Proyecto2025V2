@page "/login"
@using Proyecto2025.Shared.DTO
@inject NavigationManager Navigation


<h3>Iniciar sesión</h3>


<div style="width: 300px; margin: 50px auto; padding: 20px; border: 1px solid #ccc;">


    @if (!string.IsNullOrEmpty(errorMessage))
    {
        <p style="color: red; border: 1px solid red; padding: 5px;">@errorMessage</p>
    }

    <form @onsubmit="HandleLogin">


        <div style="margin-bottom: 10px;">
            <label for="email">E-mail o Nombre de usuario</label>

            <input id="email" @bind="loginModel.Email" type="text" style="width: 100%; padding: 5px;" />
        </div>


        <div style="margin-bottom: 15px;">
            <label for="password">Contraseña</label>
            <input type="password" id="password" @bind="loginModel.Password" style="width: 100%; padding: 5px;" />
        </div>


        <button type="submit" style="width: 100%; padding: 8px; background-color: blue; color: white; border: none;">
            Iniciar Sesión
        </button>
    </form>

    <div style="margin-top: 15px; text-align: center;">

        <a href="#">¿Olvidaste tu contraseña?</a>
    </div>

    @*  *@
    <p style="margin-top: 20px; padding: 8px; border: 1px solid #eee; background-color: #f9f9f9; font-size: 0.9em;">
        Si aún no tienes cuenta solicite su registro al administrador
    </p>

</div>

@code {
    private LoginDTO loginModel = new LoginDTO();
    private string errorMessage = string.Empty;
    private bool isLoading = false;

    private async Task HandleLogin()
    {


        await Task.Delay(500);

        if (string.IsNullOrWhiteSpace(loginModel.Email) || string.IsNullOrWhiteSpace(loginModel.Password))
        {

            errorMessage = "Debe ingresar E-mail y Contraseña.";
        }
        else if (loginModel.Email.Equals("error", StringComparison.OrdinalIgnoreCase))
        {

            errorMessage = "Credenciales no válidas. Intente de nuevo.";
        }
        else
        {
            Navigation.NavigateTo("/", forceLoad: false);
        }
    }
}

